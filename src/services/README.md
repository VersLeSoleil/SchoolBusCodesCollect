# 登录服务说明


---

## 文件路径
`src/services/loginService.js`

---

## 功能简介

该模块主要实现以下功能：
1. 验证用户输入的账号和密码是否为空。
2. 使用 `axios` 向后端发送登录请求，并设置请求超时时间。
3. 根据服务器返回的状态处理登录逻辑：
   - 登录成功：保存用户名到全局状态并跳转到首页。
   - 登录失败：显示具体的错误提示。
4. 处理可能出现的网络错误或服务器错误。

---

## 方法说明

### `handleLogin`
**功能**：  
处理用户的登录请求，验证用户输入并发送登录数据到后端。

**详细说明**：
- 验证账号和密码：
  - 如果账号或密码为空，则提示用户，并终止操作。
- 与后端交互：
  - 使用 `POST` 请求将用户输入的账号和密码发送到后端登录接口。
  - 设置请求超时时间为 5000 毫秒（5 秒）。
- 登录成功：
  - 将用户名保存到全局状态（通过 `Pinia` 的 `useUserStore`）。
  - 提示用户登录成功并跳转到 `/home` 页面。
- 登录失败：
  - 根据后端返回的错误信息显示失败提示。
- 错误处理：
  - 包括服务器错误（返回非 2xx 状态码）、网络错误（未收到服务器响应）和请求配置错误。

**函数签名**：
```javascript
handleLogin()
```

**错误处理逻辑**：
- **服务器错误**：服务器响应状态码超出 2xx 范围。
  - 日志：记录 `error.response.data`。
  - 提示：显示服务器返回的错误信息或 "未知错误"。
- **网络错误**：请求已发送但未收到响应。
  - 日志：记录 `error.request`。
  - 提示：提示用户检查网络或服务器状态。
- **请求配置错误**：请求未正确配置。
  - 日志：记录 `error.message`。
  - 提示：显示请求的配置错误信息。

---

## 使用方法

### 1. 引入模块
在需要使用登录服务的地方引入 `loginService` 模块：
```javascript
import loginService from '@/services/loginService';
```

### 2. 调用方法
在组件中调用 `handleLogin` 方法处理登录逻辑：
```javascript
loginService.handleLogin();
```

---

## 依赖说明

- **Vue Router**：用于页面跳转（`this.$router.push('/home')`）。
- **Pinia**：用于全局状态管理，保存用户登录信息。
- **Axios**：用于发起 HTTP 请求和处理网络交互。
  - 请求地址：`http://localhost:8888/api/login`
  - 默认超时时间：5 秒

---

## 注意事项

1. **开发环境要求**：
   - 确保后端服务已在本地启动，默认地址为 `http://localhost:8888/api/login`。
   - 前端与后端需在同一网络环境中运行。
2. **账号与密码验证**：
   - 输入框不能为空，否则无法发送请求。
   - 验证逻辑在 `handleLogin` 方法中处理。
3. **异常处理**：
   - 如果后端接口返回错误代码，请检查后端日志或响应内容。
   - 如果请求未响应，检查网络状态和后端服务是否正常运行。

---

## 常见问题

1. **Q: 为什么提示“账号或密码不能为空”？**  
   **A**: 请确保在输入框中填入有效的账号和密码后再点击登录。

2. **Q: 为什么登录失败，提示“未收到服务器响应”？**  
   **A**: 可能的原因：
   - 后端服务未启动。
   - 前端与后端的网络连接存在问题。
   - 服务器响应超时。

3. **Q: 如何更改请求地址或超时时间？**  
   **A**: 修改代码中的 `axios.post` 配置，例如：
   ```javascript
   axios.post("新的接口地址", { ... }, { timeout: 10000 });
   ```

---
